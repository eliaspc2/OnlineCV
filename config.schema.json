{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/json-site.schema.json",
  "title": "JSON Site Config",
  "type": "object",
  "required": ["meta", "pages"],
  "properties": {
    "meta": {
      "type": "object",
      "required": ["lang", "theme", "classPresetsFile"],
      "properties": {
        "title": {"type": "string"},
        "titleKey": {"type": "string"},
        "lang": {"type": "string"},
        "description": {"type": "string"},
        "descriptionKey": {"type": "string"},
        "defaultLanguage": {"type": "string"},
        "classPresetsFile": {"type": "string"},
        "theme": {
          "type": "object",
          "required": ["bg", "text", "muted", "accent"],
          "properties": {
            "bg": {"type": "string"},
            "text": {"type": "string"},
            "muted": {"type": "string"},
            "accent": {"type": "string"}
          },
          "additionalProperties": true
        },
        "classPresets": {
          "type": "object",
          "additionalProperties": {"$ref": "#/definitions/classPresetValue"},
          "description": "Deprecated. Use meta.classPresetsFile and data/class-keys.json."
        },
        "styles": {
          "type": "object",
          "properties": {
            "order": {
              "type": "array",
              "items": {"type": "string"}
            }
          },
          "additionalProperties": {
            "anyOf": [
              {"type": "string"},
              {
                "type": "array",
                "items": {
                  "anyOf": [
                    {"type": "string"},
                    {"$ref": "#/definitions/styleValue"}
                  ]
                }
              },
              {"$ref": "#/definitions/styleValue"}
            ]
          }
        },
        "languages": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["code", "label", "flag"],
            "properties": {
              "code": {"type": "string"},
              "label": {"type": "string"},
              "stringsFile": {"type": "string"},
              "flag": {"type": "string"}
            },
            "additionalProperties": true
          }
        }
        ,
        "favicon": {
          "type": "object",
          "properties": {
            "icon": {"type": "string"},
            "appleTouchIcon": {"type": "string"},
            "maskIcon": {"type": "string"},
            "color": {"type": "string"}
          },
          "additionalProperties": true
        },
        "pwa": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean"},
            "name": {"type": "string"},
            "nameKey": {"type": "string"},
            "shortName": {"type": "string"},
            "shortNameKey": {"type": "string"},
            "description": {"type": "string"},
            "descriptionKey": {"type": "string"},
            "startUrl": {"type": "string"},
            "scope": {"type": "string"},
            "display": {"type": "string"},
            "orientation": {"type": "string"},
            "themeColor": {"type": "string"},
            "backgroundColor": {"type": "string"},
            "icons": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["src"],
                "properties": {
                  "src": {"type": "string"},
                  "sizes": {"type": "string"},
                  "type": {"type": "string"},
                  "purpose": {"type": "string"}
                },
                "additionalProperties": true
              }
            }
          },
          "additionalProperties": true
        }
      },
      "additionalProperties": true
    },
    "objects": {
      "type": "object",
      "additionalProperties": { "$ref": "#/definitions/objectNode" }
    },
    "layout": {
      "type": "object",
      "properties": {
        "header": {"type": "array", "items": {"$ref": "#/definitions/deployedNode"}},
        "footer": {"type": "array", "items": {"$ref": "#/definitions/deployedNode"}},
        "floating": {"type": "array", "items": {"$ref": "#/definitions/deployedNode"}}
      },
      "additionalProperties": true
    },
    "pages": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["id", "sections"],
        "properties": {
          "id": {"type": "string"},
          "title": {"type": "string"},
          "sections": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["id", "nodes"],
              "properties": {
                "id": {"type": "string"},
                "nodes": {"type": "array", "items": {"$ref": "#/definitions/deployedNode"}}
              },
              "additionalProperties": true
            }
          }
        },
        "additionalProperties": true
      }
    }
  },
  "definitions": {
    "classPresetValue": {
      "anyOf": [
        {"type": "string"},
        {
          "type": "object",
          "additionalProperties": {"$ref": "#/definitions/classPresetValue"}
        }
      ]
    },
    "styleValue": {
      "anyOf": [
        {"type": "string"},
        {
          "type": "array",
          "items": {
            "anyOf": [
              {"type": "string"},
              {"$ref": "#/definitions/styleValue"}
            ]
          }
        },
        {
          "type": "object",
          "additionalProperties": {"$ref": "#/definitions/styleValue"}
        }
      ]
    },
    "objectNode": {
      "type": "object",
      "required": ["tag", "classKey"],
      "properties": {
        "id": {"type": "string"},
        "ref": {"type": "string"},
        "i18nKey": {"type": "string"},
        "tag": {"type": "string"},
        "class": {"type": "string"},
        "classKey": {"type": "string"},
        "text": {"type": "string"},
        "textKey": {"type": "string"},
        "attrs": {"type": "object", "additionalProperties": {"type": "string"}},
        "attrsI18n": {"type": "object", "additionalProperties": {"type": "string"}},
        "styles": {"type": "object", "additionalProperties": {"type": "string"}},
        "children": {"type": "array", "items": {"$ref": "#/definitions/objectNode"}}
      },
      "additionalProperties": true
    },
    "deployedNode": {
      "type": "object",
      "required": ["id", "ref"],
      "properties": {
        "id": {"type": "string"},
        "ref": {"type": "string"},
        "attrs": {"type": "object", "additionalProperties": {"type": "string"}},
        "styles": {"type": "object", "additionalProperties": {"type": "string"}},
        "children": {"type": "array", "items": {"$ref": "#/definitions/deployedNode"}}
      },
      "anyOf": [
        {"required": ["id", "ref"]}
      ],
      "additionalProperties": false
    }
  }
}
