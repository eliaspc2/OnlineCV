<!doctype html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Editor JSON — Currículo</title>
  <link rel="icon" type="image/png" href="assets/images/brand/favicon.png" />
  <link rel="apple-touch-icon" href="assets/images/brand/apple-touch-icon.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="editor.css" />
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="brand">Editor JSON — Currículo</div>
      <div class="actions">
        <button id="loadAllBtn">Carregar ficheiros</button>
        <button id="validateBtn">Validar</button>
        <button id="downloadBtn">Download</button>
        <button id="exitBtn">Sair</button>
      </div>
    </header>
    <main class="main">
      <div class="editor-pane">
        <div class="file-tabs" id="fileTabs"></div>
        <div class="aggregate-view hidden" id="aggregateView">
          <div class="tree-pane">
            <div class="panel-title">Árvore</div>
            <div class="tree-list" id="aggregateTree"></div>
          </div>
          <div class="detail-pane">
            <div class="panel-title">JSON</div>
            <div class="detail-list" id="aggregateDetail"></div>
          </div>
        </div>
        <div class="classkey-builder hidden" id="classKeyBuilderView">
          <div class="classkey-library-pane">
            <div class="panel-title">Objetos</div>
            <div class="classkey-toolbar">
              <input id="ckSearch" type="text" placeholder="Pesquisar class key..." />
              <select id="ckGroupFilter"></select>
            </div>
            <div class="classkey-library-list" id="ckLibrary"></div>
          </div>
          <div class="classkey-canvas-pane">
            <div class="panel-title">Composição</div>
            <div class="classkey-dropzone" id="ckDropZone">
              Arraste peças para aqui ou clique numa peça na barra lateral.
            </div>
            <div class="classkey-selection" id="ckSelection"></div>
            <div class="classkey-field">
              <label for="ckManualTokens">Tokens extra</label>
              <textarea id="ckManualTokens" spellcheck="false"></textarea>
            </div>
            <div class="classkey-field">
              <label for="ckPreview">Classe final</label>
              <textarea id="ckPreview" spellcheck="false" readonly></textarea>
            </div>
          </div>
          <div class="classkey-config-pane">
            <div class="panel-title">Definição</div>
            <div class="classkey-field">
              <label for="ckExisting">Carregar class key existente</label>
              <select id="ckExisting"></select>
            </div>
            <div class="classkey-field">
              <label for="ckTargetGroup">Grupo alvo</label>
              <input id="ckTargetGroup" type="text" placeholder="visual.hero" />
            </div>
            <div class="classkey-field">
              <label for="ckTargetKey">Nome da class key</label>
              <input id="ckTargetKey" type="text" placeholder="reveal_opacity_0" />
            </div>
            <div class="classkey-actions">
              <button id="ckSaveBtn" type="button">Guardar class key</button>
              <button id="ckClearBtn" type="button">Limpar composição</button>
            </div>
            <div class="classkey-status" id="ckStatus"></div>
          </div>
        </div>
        <textarea id="editor" spellcheck="false"></textarea>
      </div>
      <aside class="side">
        <h3>Ajuda</h3>
        <p>Edite o <code>public/data/config.json</code> (objetos + deploy) e <code>public/data/class-keys.json</code> (estilos).</p>
        <p>As strings ficam em <code>public/data/pt-pt.json</code>, <code>public/data/es-es.json</code>, <code>public/data/fr-fr.json</code> e <code>public/data/uk-en.json</code>.</p>
        <p>Contrato: deploy usa <code>id + ref</code>; texto vai para idiomas em <code>obj.&lt;id&gt;</code>.</p>
        <p><strong>Carregar ficheiros</strong> puxa e guarda os JSONs centrais.</p>
        <p><strong>Download</strong> gera o ficheiro que está selecionado.</p>
        <p>O conteúdo também fica em <code>localStorage</code> como rascunho.</p>
        <p><strong>Agregado</strong> mostra uma árvore (estilo regedit) e um painel JSON filtrado pela seleção.</p>
        <p><strong>Class Keys Visual</strong> permite combinar peças visuais e gravar no <code>class-keys.json</code>.</p>
        <p>O editor abre no <strong>Agregado</strong> por defeito.</p>
      </aside>
    </main>
  </div>
  <script type="module" src="editor.js"></script>
</body>
</html>
